---
- name: Create host group with single IP fetched from survey input
  hosts: localhost
  gather_facts: no
  
  vars:
    ip_address: "{{ survey_ip }}"  
  
  tasks:
  - name: Create temp host group from ip provided in survey
    add_host:
      hostname: "{{ ip_address }}"
      groupname: tmp_group      

- name: Verify basic accessibility of {{ ip_address }}
  hosts: tmp_group,!localhost
  gather_facts: no
  become: true
  
  tasks:
  - action: ping

- name: Setup aklops user
  hosts: tmp_group,!localhost
  gather_facts: no
  
  tasks:
  - debug:
     msg: "setting up aklops user"

- name: Tag Nectar VM as set up
  hosts: tmp_group,!localhost
  gather_facts: no
  
  tasks:
  - debug:
     msg: "tagging nectar vm"
